<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.srm.purchasecooperation.cux.pr.infra.mapper.RcwlPrLineHisMapper">

    <select id="selectList" resultType="org.srm.purchasecooperation.pr.domain.entity.PrLine">
        SELECT
            spl.object_version_number,
            srplh.*
        FROM
            ( SELECT MAX( version ) version, pr_line_id, pr_header_id FROM scux_rcwl_pr_line_his WHERE pr_header_id = #{prHeaderId} AND tenant_id = #{tenantId} ) temp,
            scux_rcwl_pr_line_his srplh
                LEFT JOIN sprm_pr_line spl ON srplh.pr_header_id = spl.pr_header_id
                AND srplh.pr_line_id = spl.pr_line_id
        WHERE
            srplh.pr_header_id = temp.pr_header_id
          AND srplh.version = temp.version
    </select>
</mapper>
